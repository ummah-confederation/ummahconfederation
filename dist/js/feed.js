function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t,n={};var a=e(function(){if(t)return n;t=1;const e="darkMode";function a(){const e=new URLSearchParams(window.location.search),t=e.get("institution"),n=e.get("jurisdiction");return t?{type:"institution",name:t}:n?{type:"jurisdiction",name:n}:{type:"global",name:"Global Feed"}}async function i(){const e=document.getElementById("prayer-times-widget");if(e)try{const e=await async function(){return new Promise((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async t=>{const n={latitude:t.coords.latitude,longitude:t.coords.longitude};try{const e=await fetch(`https://corsproxy.io/?${encodeURIComponent(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${n.latitude}&lon=${n.longitude}`)}`),t=await e.json();n.city=t.address.city||t.address.town||t.address.village||t.address.county||"Unknown",n.country=t.address.country||"Unknown"}catch(e){n.city="Unknown",n.country="Unknown"}e(n)},()=>{e({latitude:-6.2088,longitude:106.8456,city:"Jakarta",country:"Indonesia"})}):t(new Error("Geolocation is not supported"))})}(),t=await async function(e){const t=function(e){try{const t=s(e),n=localStorage.getItem(t);if(n){const e=JSON.parse(n),t=new Date(e.date),a=new Date;if(t.toDateString()===a.toDateString())return e.prayerTimes}}catch(e){}return null}(e);if(t)return t;const n=new Date,a=n.getDate(),i=n.getMonth()+1,r=n.getFullYear(),o=`https://api.aladhan.com/v1/timings/${a}-${i}-${r}?latitude=${e.latitude}&longitude=${e.longitude}&method=20`,c=await fetch(o),d=await c.json();if(200===d.code&&d.data){const t={Fajr:d.data.timings.Fajr,Dhuhr:d.data.timings.Dhuhr,Asr:d.data.timings.Asr,Maghrib:d.data.timings.Maghrib,Isha:d.data.timings.Isha};return function(e,t){try{const n=s(e),a={date:(new Date).toISOString(),prayerTimes:t};localStorage.setItem(n,JSON.stringify(a))}catch(e){}}(e,t),t}throw new Error("Failed to fetch prayer times")}(e);r(e,t),setInterval(()=>{r(e,t)},1e3)}catch(t){e.innerHTML='<p class="text-center">Unable to load prayer times.</p>'}}function s(e){const t=new Date;return`prayerTimesCache_${`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`}_${`${e?.latitude?.toFixed(2)}_${e?.longitude?.toFixed(2)}`}`}function r(e,t){const n=document.getElementById("prayer-times-widget");if(!n)return;const a=(new Date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),i=(new Date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),{nextPrayer:s,timeToNext:r}=function(e){const t=new Date,n=60*t.getHours()+t.getMinutes(),a=[{name:"Fajr",time:e.Fajr},{name:"Dhuhr",time:e.Dhuhr},{name:"Asr",time:e.Asr},{name:"Maghrib",time:e.Maghrib},{name:"Isha",time:e.Isha}].map(e=>{const[t,n]=e.time.split(":").map(Number);return{name:e.name,time:e.time,minutes:60*t+n}});let i=null;for(const e of a)if(e.minutes>n){i=e;break}if(!i)return i=a[0],{nextPrayer:i,timeToNext:1440-n+i.minutes};return{nextPrayer:i,timeToNext:i.minutes-n}}(t),o=function(e){const t=Math.floor(e/60),n=e%60;return t>0?`${t}h ${n}m`:`${n}m`}(r);n.innerHTML=`\n    <div class="prayer-widget-header">\n      <h3 class="prayer-widget-title">Prayer Time Widget</h3>\n    </div>\n    <div class="prayer-widget-header">\n      <span class="prayer-widget-date">${a}</span>\n      <span class="prayer-widget-clock">${i}</span>\n    </div>\n    <div class="prayer-widget-location">üìç ${e.city}, ${e.country}</div>\n    <div class="prayer-widget-next">\n      <span class="prayer-widget-next-label">Next Prayer:</span> ${s.name} (${o})\n    </div>\n    <div class="prayer-widget-times">\n      <div class="prayer-widget-column">\n        <span class="prayer-widget-name">Fajr</span>\n        <span class="prayer-widget-time">${t.Fajr}</span>\n      </div>\n      <div class="prayer-widget-column">\n        <span class="prayer-widget-name">Dhuhr</span>\n        <span class="prayer-widget-time">${t.Dhuhr}</span>\n      </div>\n      <div class="prayer-widget-column">\n        <span class="prayer-widget-name">Asr</span>\n        <span class="prayer-widget-time">${t.Asr}</span>\n      </div>\n      <div class="prayer-widget-column">\n        <span class="prayer-widget-name">Maghrib</span>\n        <span class="prayer-widget-time">${t.Maghrib}</span>\n      </div>\n      <div class="prayer-widget-column">\n        <span class="prayer-widget-name">Isha</span>\n        <span class="prayer-widget-time">${t.Isha}</span>\n      </div>\n    </div>\n  `}async function o(e=!1){const t=a(),n=document.getElementById("prayer-times-widget");"institution"===t.type?await async function(e,t,n=!1){try{const{getInstitutionFeedConfig:a,getDocumentById:s}=await import("./config-BsZ8KEZg.js"),r=await a(e);if(r?.widget?.enabled?await i():t&&(t.style.display="none"),r?.carousel){n&&c();const e=await Promise.all(r.carousel.images.map(async e=>{const t=e.document_id?await s(e.document_id):null;return{...e,document:t}})),t={...r.carousel,images:e};d(t,r.carousel.post_to_jurisdictions?.[0]||"","institution")}}catch(e){}}(t.name,n,e):"jurisdiction"===t.type?await async function(e,t,n=!1){try{const{getJurisdictionFeedConfig:a,getJurisdictionCarousels:s}=await import("./config-BsZ8KEZg.js"),r=await a(e);r?.widget?.enabled?await i():t&&(t.style.display="none"),n&&c();(await s(e)).forEach(e=>{d(e,e.institution,"jurisdiction")})}catch(e){}}(t.name,n,e):await i()}function c(){const e=document.querySelector(".paper-sheet");if(!e)return;e.querySelectorAll(".feed-carousel").forEach(e=>e.remove())}function d(e,t,n){try{const a=document.querySelector(".paper-sheet");if(!a)return;const i="institution"===n?`Posted in ${t.replace(/\s*\[.*?\]\s*/g,"").trim()}`:`Posted by ${t.replace(/\s*\[.*?\]\s*/g,"").trim()}`,s=`carousel-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r=`\n      <div class="feed-carousel" id="${s}">\n        <div class="carousel-header">\n          <h3 class="carousel-title">${e.title}</h3>\n        </div>\n        <div class="carousel-container">\n          <div class="carousel-track" id="${s}-track">\n            ${e.images.map((e,t)=>{const n=e.document?.title||"Untitled",a=e.document?.filename||"#";return`\n              <div class="carousel-slide">\n                <img src="${e.url}" alt="${n}" loading="${0===t?"eager":"lazy"}" decoding="async" fetchpriority="${0===t?"high":"auto"}">\n                <div class="carousel-caption">\n                  <a href="${a}" class="carousel-caption-link">${n}</a>\n                </div>\n              </div>\n            `}).join("")}\n          </div>\n          <button class="carousel-nav prev" aria-label="Previous slide">‚Äπ</button>\n          <button class="carousel-nav next" aria-label="Next slide">‚Ä∫</button>\n        </div>\n        <div class="carousel-footer">\n          <div class="carousel-indicators">\n            ${e.images.map((e,t)=>`\n              <button class="carousel-indicator ${0===t?"active":""}" data-index="${t}" aria-label="Go to slide ${t+1}"></button>\n            `).join("")}\n          </div>\n          <span class="carousel-source">${i}</span>\n        </div>\n      </div>\n    `;a.insertAdjacentHTML("beforeend",r),function(e,t){const n=document.getElementById(e);if(!n)return;const a=document.getElementById(`${e}-track`),i=n.querySelector(".carousel-nav.prev"),s=n.querySelector(".carousel-nav.next"),r=n.querySelectorAll(".carousel-indicator");let o,c=0;function d(e){e<0&&(e=t-1),e>=t&&(e=0),c=e,a.style.transform=`translateX(-${100*c}%)`,r.forEach((e,t)=>{e.classList.toggle("active",t===c)})}function l(){d(c+1)}function u(){d(c-1)}function m(){o=setInterval(l,5e3)}function g(){clearInterval(o)}function p(){g(),m()}i.addEventListener("click",()=>{u(),p()}),s.addEventListener("click",()=>{l(),p()}),r.forEach((e,t)=>{e.addEventListener("click",()=>{d(t),p()})}),m(),n.addEventListener("mouseenter",g),n.addEventListener("mouseleave",m);let y=0,h=0;function w(){const e=50,t=y-h;Math.abs(t)>e&&(t>0?l():u())}n.addEventListener("touchstart",e=>{y=e.changedTouches[0].screenX,g()},{passive:!0}),n.addEventListener("touchend",e=>{h=e.changedTouches[0].screenX,w(),m()},{passive:!0})}(s,e.images.length)}catch(e){}}return document.addEventListener("DOMContentLoaded",()=>{!function(){const t=document.querySelector(".admin-seal");if(!t)return;const n=localStorage.getItem(e),a=window.matchMedia("(prefers-color-scheme: dark)").matches;("true"===n||!n&&a)&&document.documentElement.classList.add("dark"),t.addEventListener("click",()=>{document.documentElement.classList.toggle("dark");const t=document.documentElement.classList.contains("dark");localStorage.setItem(e,t)})}(),function(){const e=a(),t=document.getElementById("feed-header");if(t)if("global"===e.type)t.textContent="Global Feed";else if("institution"===e.type){const n=e.name.replace(/\s*\[.*?\]\s*/g,"").trim();t.textContent=`${n} Feed`}else if("jurisdiction"===e.type){const n=e.name.replace(/\s*\[.*?\]\s*/g,"").trim();t.textContent=`${n} Feed`}}(),o(!1)}),window.addEventListener("pageshow",e=>{e.persisted&&o(!0)}),n}());export{a as default};
